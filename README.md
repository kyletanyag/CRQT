# Cyber Resiliency Quantification Tool (CRQT)

# Web Tool
## Prerequisities
Make sure you have the following downloaded:
- [Node.js](https://nodejs.org/en/)
- [Ubuntu Subsystem for Windows](https://docs.microsoft.com/en-us/windows/wsl/install-win10). Install Ubuntu 20.04. 
- [Install Mongo Windows Service](https://docs.mongodb.com/manual/tutorial/install-mongodb-on-windows/#run-mongodb-from-cmd)
- [Python w/ pip](https://www.python.org/downloads/)

## Initial Project Setup
### 1. You will need to download all the dependencies for the front-end application.
In Windows Powershell/CMD Terminal from root folder run the following commands:
```
cd .\FrontEnd\
npm install
```
Note: The npm install command only has to be run once. This downloads all the needed packages for Vue to compile and serve the application. It will take a while to run the first time as it has to download packages.

### 2. You will need to download all the dependencies for the back-end Flask server.
In Windows Powershell/CMD Terminal from root folder run the following commands:
```
cd .\BackEnd\
pip install -r requirements.txt
```

### 3. You will need to begin intialization of the [CVE-Search](https://github.com/cve-search/cve-search) project
#### For automatic install of CVE-Search:
In Ubuntu Terminal from root folder run the following commands:
```
$ cd ./BackEnd
$ chmod 700 ./cve_search_install.sh 
$ ./cve_search_install.sh
```

#### For manual install of CVE-Search:
In Ubuntu Terminal from root folder run the following commands:
```
$ sudo apt-get install python3
$ sudo apt-get install python3-pip
$ sudo apt-get install redis-server
$ pip3 install flask flask-pymongo
$ sudo service redis-server start
```

In same terminal, download cve data: 
```
$ cd ./BackEnd/dms/cve_search/
$ python3 ./sbin/db_mgmt_cpe_dictionary.py -p
$ python3 ./sbin/db_mgmt_json.py -p
$ python3 ./sbin/db_updater.py -c # This will take >45minutes on a decent machine, please be patient.
```


## To Run Project
Once all servers are running, the CRQT application will be running at http://localhost:8080/.

### Run Front-End Server (Port 8080)
In Windows Powershell/CMD Terminal from root folder run the following commands:
```
cd .\FrontEnd\
npm run build
```

### Run Back-End Flask Server (Port 5000)
In Windows Powershell/CMD Terminal from root folder run the following commands:
```
.\BackEnd\startup_flask.bat
```

### Run Back-End CVE-Search Server (Port 2000)
In Ubuntu Terminal from root folder run the following commands:
```
$ sudo service redis-server start
```

In Windows Powershell/CMD Terminal from root folder run the following commands:
```
.\BackEnd\startup_cve_search.bat
```

### Updating Databases
To ensure results generated by the CRQT have the most up-to-date NVD Data, it is highly recommended to update the CVE-Search database weekly.
#### To fully repopulate the CVE-Search NVD database
In Ubuntu Terminal from root folder run the following commands:
```
$ cd ./BackEnd/dms/cve_search/
$ sudo service redis-server start
$ python3 ./sbin/db_updater.py -v -f
```

#### To update without fully repopulating database
In Ubuntu Terminal from root folder run the following commands:
```
$ cd ./BackEnd/dms/cve_search/
$ sudo service redis-server start
$ python3 ./sbin/db_updater.py -v
```

# Non-Web Tool
Allows you to use tool without front-end or back-end servers using Python scripts under .\non_web. CVE Search will still be required. 

## Prerequisities
Make sure you have the following downloaded:
- [Ubuntu Subsystem for Windows](https://docs.microsoft.com/en-us/windows/wsl/install-win10). Install Ubuntu 20.04. 
- [Install Mongo Windows Service](https://docs.mongodb.com/manual/tutorial/install-mongodb-on-windows/#run-mongodb-from-cmd)
- [Python w/ pip](https://www.python.org/downloads/)

## Initial Project Setup
### 1. You will need to download all the dependencies for CVE Search
In Windows Powershell/CMD Terminal from root folder run the following commands:
```
cd .\BackEnd\
pip install -r requirements.txt
```

### 2. You will need to begin intialization of the [CVE-Search](https://github.com/cve-search/cve-search) project
#### For automatic install of CVE-Search:
In Ubuntu Terminal from root folder run the following commands:
```
$ cd ./BackEnd
$ chmod 700 ./cve_search_install.sh 
$ ./cve_search_install.sh
```

#### For manual install of CVE-Search:
In Ubuntu Terminal from root folder run the following commands:
```
$ sudo apt-get install python3
$ sudo apt-get install python3-pip
$ sudo apt-get install redis-server
$ pip3 install flask flask-pymongo
$ sudo service redis-server start
```

In same terminal, download cve data: 
```
$ cd ./BackEnd/dms/cve_search/
$ python3 ./sbin/db_mgmt_cpe_dictionary.py -p
$ python3 ./sbin/db_mgmt_json.py -p
$ python3 ./sbin/db_updater.py -c # This will take >45minutes on a decent machine, please be patient.
```


## To Run Project
To use computational modules without front- or back-end servers, you must create python scripts that utilize .\non_web. Examples on utilization can be found in .\web\example.

When running examples, run CVE Search in background. 

### Run CVE-Search Server (Port 2000)
In Ubuntu Terminal from root folder run the following commands:
```
$ sudo service redis-server start
```

In Windows Powershell/CMD Terminal from root folder run the following commands:
```
.\BackEnd\startup_cve_search.bat
```

### model-driven input format
To use model-driven analysis modules, you must use correct model-driven topology format. 

The input is formatted in a JSON file with two JSON objects: vertices and arcs. The vertices contains a list of nodes in network. Each node attribute will contain: node id, vendor, product, NIST Control Systems Security Program Recommended Architecture layer (corp_fw_1, corp_dmz, corp_fw_2, corp_lan, cs_fw_2, cs_lan - must use exect words when specifing layer), CVE IDs (can use CVE Search to find CVE IDs for product). The arcs contains a list of node edges. Each edge attribute contains: current node id, list of next nodes from current node. 
